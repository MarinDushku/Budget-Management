<UserControl x:Class="BudgetManagement.Views.UserControls.RecentEntriesUserControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:converters="clr-namespace:BudgetManagement.Converters"
             FontFamily="Segoe UI"
             FontSize="14">

    <UserControl.Resources>
        <converters:CurrencyConverter x:Key="CurrencyConverter"/>
        <converters:DateConverter x:Key="DateConverter"/>
        <converters:TextTruncateConverter x:Key="TextTruncateConverter"/>
        <converters:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        
        <!-- Entry card style -->
        <Style x:Key="EntryCard" TargetType="Border">
            <Setter Property="Background" Value="#FAFAFA"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="Margin" Value="0,2"/>
            <Setter Property="Padding" Value="12,8"/>
        </Style>
        
        <!-- Entry type icon style -->
        <Style x:Key="EntryIcon" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>
        
        <!-- Entry amount style -->
        <Style x:Key="EntryAmount" TargetType="TextBlock">
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <!-- Income amount style -->
        <Style x:Key="IncomeAmount" TargetType="TextBlock" BasedOn="{StaticResource EntryAmount}">
            <Setter Property="Foreground" Value="#4CAF50"/>
        </Style>
        
        <!-- Spending amount style -->
        <Style x:Key="SpendingAmount" TargetType="TextBlock" BasedOn="{StaticResource EntryAmount}">
            <Setter Property="Foreground" Value="#F44336"/>
        </Style>
        
        <!-- Entry description style -->
        <Style x:Key="EntryDescription" TargetType="TextBlock">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
        </Style>
        
        <!-- Entry date style -->
        <Style x:Key="EntryDate" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        
        <!-- Category style -->
        <Style x:Key="CategoryText" TargetType="TextBlock">
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Foreground" Value="#888888"/>
            <Setter Property="FontStyle" Value="Italic"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </UserControl.Resources>

    <StackPanel>
        <!-- Recent Income Section -->
        <TextBlock Text="{StaticResource RecentIncome}" 
                   FontWeight="Bold" 
                   FontSize="14" 
                   Margin="0,0,0,8" 
                   Foreground="#4CAF50"/>
        
        <ItemsControl ItemsSource="{Binding RecentIncomeEntries}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Style="{StaticResource EntryCard}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>  <!-- Icon -->
                                <ColumnDefinition Width="*"/>     <!-- Description -->
                                <ColumnDefinition Width="Auto"/>  <!-- Amount -->
                                <ColumnDefinition Width="Auto"/>  <!-- Date -->
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" 
                                       Text="ðŸ’°" 
                                       Style="{StaticResource EntryIcon}"/>
                            
                            <TextBlock Grid.Column="1" 
                                       Text="{Binding Description, Converter={StaticResource TextTruncateConverter}, ConverterParameter=30}" 
                                       Style="{StaticResource EntryDescription}"
                                       Margin="0,0,10,0"/>
                            
                            <TextBlock Grid.Column="2" 
                                       Text="{Binding Amount, Converter={StaticResource CurrencyConverter}}" 
                                       Style="{StaticResource IncomeAmount}"
                                       Margin="0,0,10,0"/>
                            
                            <TextBlock Grid.Column="3" 
                                       Text="{Binding Date, Converter={StaticResource DateConverter}, ConverterParameter=short}" 
                                       Style="{StaticResource EntryDate}"/>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        
        <!-- Separator -->
        <Separator Margin="0,15,0,10" Background="#E0E0E0"/>
        
        <!-- Recent Spending Section -->
        <TextBlock Text="{StaticResource RecentSpending}" 
                   FontWeight="Bold" 
                   FontSize="14" 
                   Margin="0,0,0,8" 
                   Foreground="#F44336"/>
        
        <ItemsControl ItemsSource="{Binding RecentSpendingEntries}">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Style="{StaticResource EntryCard}">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>  <!-- Icon -->
                                <ColumnDefinition Width="*"/>     <!-- Description -->
                                <ColumnDefinition Width="Auto"/>  <!-- Amount -->
                                <ColumnDefinition Width="Auto"/>  <!-- Category -->
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            
                            <TextBlock Grid.Column="0" Grid.Row="0"
                                       Text="ðŸ’¸" 
                                       Style="{StaticResource EntryIcon}"/>
                            
                            <TextBlock Grid.Column="1" Grid.Row="0"
                                       Text="{Binding Description, Converter={StaticResource TextTruncateConverter}, ConverterParameter=25}" 
                                       Style="{StaticResource EntryDescription}"
                                       Margin="0,0,10,0"/>
                            
                            <TextBlock Grid.Column="2" Grid.Row="0"
                                       Text="{Binding Amount, Converter={StaticResource CurrencyConverter}}" 
                                       Style="{StaticResource SpendingAmount}"
                                       Margin="0,0,10,0"/>
                            
                            <StackPanel Grid.Column="3" Grid.Row="0" Orientation="Vertical">
                                <TextBlock Text="{Binding Date, Converter={StaticResource DateConverter}, ConverterParameter=short}" 
                                           Style="{StaticResource EntryDate}"/>
                                <TextBlock Text="{Binding CategoryName}" 
                                           Style="{StaticResource CategoryText}"/>
                            </StackPanel>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
        
        <!-- Empty state message -->
        <TextBlock Text="{StaticResource NoRecentEntries}" 
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Margin="0,30"
                   FontSize="12"
                   Foreground="#999999"
                   Visibility="{Binding HasNoEntries, Converter={StaticResource BooleanToVisibilityConverter}}"/>
    </StackPanel>
</UserControl>